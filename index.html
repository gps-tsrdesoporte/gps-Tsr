<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Iconos PWA -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navegador de Gestiones TSR</title>
    
     <!-- ONESIGNAL PUSH NOTIFICATIONS -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({
          appId: "9b213721-614e-4145-ba29-3520c4d21af3",
          serviceWorkerPath: "/gps-Tsr/OneSignalSDKWorker.js",
          serviceWorkerParam: { scope: "/gps-Tsr/" },
          notifyButton: {
            enable: true,
          },
        });
      });
    </script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'DIN', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #E4E4E4; min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 30px; margin-bottom: 30px; }
        .header-content { margin-bottom: 20px; display: flex; align-items: center; gap: 20px; }
        .header-content img { width: 160px; height: auto; flex-shrink: 0; }
        .header-text { flex: 1; }
        .header-content h1 { color: #E4002B; font-size: 32px; margin-bottom: 5px; }
        .header-content p { color: #666; font-size: 16px; }
        .search-box { position: relative; }
        .search-box input { width: 100%; padding: 15px 15px 15px 45px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border-color 0.3s; }
        .search-box input:focus { outline: none; border-color: #E4002B; }
        .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #999; }
        .gestiones-grid { display: grid; gap: 20px; }
        .gestion-card { background: white; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 25px; border-left: 5px solid #E4002B; cursor: pointer; transition: all 0.3s; }
        .gestion-card:hover { box-shadow: 0 6px 12px rgba(0,0,0,0.15); transform: translateY(-2px); border-left-color: #b01804; }
        .gestion-card h3 { color: #333; font-size: 20px; margin-bottom: 15px; }
        .gestion-meta { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 12px; }
        .badge { padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 500; }
        .badge-destinatario { background: #ffe5e0; color: #E4002B; }
        .badge-docs { background: #e8f5e9; color: #388e3c; }
        .gestion-card p { color: #666; line-height: 1.5; }
        .detail-view { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 40px; }
        .detail-header { border-bottom: 3px solid #E4002B; padding-bottom: 20px; margin-bottom: 30px; }
        .detail-header h2 { color: #333; font-size: 28px; margin-bottom: 15px; }
        .detail-header p { color: #666; font-size: 16px; line-height: 1.6; }
        .back-button { background: #f5f5f5; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-bottom: 20px; transition: background 0.3s; }
        .back-button:hover { background: #e0e0e0; }
        .docs-section h3 { color: #333; font-size: 22px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .doc-item { background: linear-gradient(135deg, #fff5f4 0%, #ffe5e0 100%); border: 2px solid #ffccc7; border-radius: 10px; padding: 18px; margin-bottom: 15px; transition: all 0.3s; }
        .doc-item:hover { border-color: #E4002B; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .doc-content { display: flex; align-items: start; gap: 15px; }
        .doc-number { background: #E4002B; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0; }
        .doc-button { background: #E4002B; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 500; cursor: pointer; transition: background 0.3s; font-size: 14px; text-decoration: none; display: inline-block; }
        .doc-button:hover { background: #b01804; }
        .doc-text { color: #333; flex: 1; line-height: 1.6; }
        .hidden { display: none; }
        .no-results { background: white; border-radius: 12px; padding: 60px; text-align: center; color: #999; font-size: 18px; }
        .alert-text { color: #3366CC; font-weight: bold; margin-bottom: 15px; padding: 10px; background: #e6f0ff; border-radius: 5px; }
        .form-group { margin: 15px 0; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-group select, .form-group input[type="text"], .form-group input[type="date"] { width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 5px; font-size: 14px; }
        .form-group select:focus, .form-group input[type="text"]:focus, .form-group input[type="date"]:focus { outline: none; border-color: #E4002B; }
        .form-group textarea { width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 5px; font-size: 14px; font-family: inherit; resize: vertical; }
        .form-group textarea:focus { outline: none; border-color: #E4002B; }


        /* Responsive m√≥vil - Header centrado */
        @media (max-width: 480px) {
            .header-content {
                flex-direction: column !important;
                text-align: center !important;
                gap: 15px !important;
            }
            .header-content img {
                width: 140px !important;
                height: auto !important;
                margin: 0 auto;
            }
            .header-text {
                width: 100%;
            }
        }
        /* Responsive Styles */
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 22px; }
            .search-box { margin: 15px 0; }
            .gestion-card { padding: 15px; }
            .gestion-card h3 { font-size: 16px; }
            .detail-header h2 { font-size: 20px; }
            .docs-section h3 { font-size: 16px; }
            .form-group label { font-size: 14px; }
            .form-group input, .form-group select, .form-group textarea { font-size: 14px; padding: 10px; }
            .doc-button { font-size: 13px; padding: 10px 16px; }
            .badge { font-size: 11px; padding: 4px 10px; }
            .back-button { font-size: 13px; padding: 8px 16px; }
            table { font-size: 12px; }
            table th, table td { padding: 6px !important; font-size: 11px !important; }
        }
        
        @media (max-width: 480px) {
            .container { padding: 10px; }
            .header h1 { font-size: 18px; }
            .gestion-grid { grid-template-columns: 1fr; }
            .gestion-card { padding: 12px; }
            .gestion-card h3 { font-size: 15px; }
            .detail-header h2 { font-size: 18px; }
            .form-group { margin-bottom: 12px; }
            .doc-item { flex-direction: column; align-items: stretch; }
            .doc-content { flex-direction: column; }
            .doc-number { margin-right: 0; margin-bottom: 8px; }
            .doc-button { width: 100%; margin-top: 8px; }
            table { display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <img src="mapfre-isotipo.png" alt="Logo MAPFRE">
                <div class="header-text">
                    <h1>Navegador de Gestiones TSR</h1>
                    <p>Te ayudamos a encontrar la ruta en tus tareas üòâ</p>
                </div>
            </div>
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" placeholder="Buscar por tipo de gesti√≥n, destinatario o descripci√≥n...">
            </div>
        </div>
        <div id="listView" class="gestiones-grid"></div>
        <div id="detailView" class="hidden"></div>
        <div id="noResults" class="no-results hidden">No se encontraron resultados</div>
    </div>
    <script>
const gestiones=[{id:1,tipo:"Gesti√≥n de Altas, Bajas y Contratos de Proveedores",destinatario:"Tsr de Soporte",descripcion:"Procedimiento gesti√≥n de contratos en nuevas incorporaciones y cambios de raz√≥n social",documentos:[{texto:"Gesti√≥n de Contratos de Colaboraci√≥n Proveedores Patrimoniales",url:"https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Operativas/Gesti%C3%B3n%20de%20Contratos%20de%20Colaboraci%C3%B3n%20Proveedores%20Patrimoniales.doc?d=w43758a8a6d424b1a8b62417212b6def5&csf=1&web=1&e=2q1jXU"},{texto:"Plantilla de Solicitud Contrato de Alta Reparadores - Cambio raz√≥n social",url:"https://mapfrecorp.sharepoint.com/:x:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Solicitud%20Contrato,%20Alta%20Reparadores%20vJUL25.xlsx?d=wc8f4d9207a5f4ca9a703e359993a683d&csf=1&web=1&e=xV90Cf"},{texto:"Plantilla de Solicitud Baja Total Proveedor",url:"https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Resoluci%C3%B3n%20Contrato%20Proveedor.docx?d=w179afc2a308d4e969c4f9d4a5d7875e8&csf=1&web=1&e=RrSLLV"},{texto:"Plantilla Comunicaci√≥n Baja Voluntaria Proveedor",url:"https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Comunicaci%C3%B3n%20Resoluci%C3%B3n%20Voluntaria%20Contrato%20Proveedor.docx?d=wf69ea18b8c664667ae053641a9c6e71b&csf=1&web=1&e=g2X1fO"},{texto:"Enviar solicitud a Soporte",url:"SPECIAL_FORM_1"}]},{id:2,tipo:"Gestiones Operativas - Cambios de guardia",destinatario:"Tsr de Soporte",descripcion:"Para cambios de guardia es imprescindible rellenar plantilla y revisar datos correctos de N¬∫ Profesional / Zonas / Actividad. Evita en lo posible cambios por d√≠as, prioriza sustituciones por semana completa guardia. Traslada cuadrantes de guardias a tus profesionales con antelaci√≥n. Revisa programaci√≥n en bajas totales.",documentos:[{texto:"Formulario Cambio de Guardia",url:"SPECIAL_FORM_CAMBIO_GUARDIA"}]},{id:3,tipo:"Gestiones Operativas - Altas / bajas temporales",destinatario:"Tsr de Soporte",descripcion:"‚ö†Ô∏èPresta atenci√≥n en las comunicaciones con Proveedores ‚Äì Laboralidad. Recuerda que el profesional puede solicitar esta gesti√≥n a Soporte, salvo que el motivo sea por indicaciones de TSR como incidencias, incumplimientos, etc. Especifica estos motivos en el correo a Soporte. No utilices este canal para las vacaciones estivales planificadas.",documentos:[{texto:"Formulario Alta/Baja Temporal",url:"SPECIAL_FORM_ALTA_BAJA"}]},{id:5,tipo:"Gestiones Operativas - Zonas / Preasignaciones / Actividades / L√≠mites de trabajos",destinatario:"Tsr de Soporte",descripcion:"En este bloque se solicitan gestiones relacionadas con modificaciones de zonas y/o actividades a profesionales as√≠ como las preasignaciones y l√≠mites que se requieren en la correcta asignaci√≥n y distribuci√≥n de servicios. La creaci√≥n de zonas, asignaci√≥n de c√≥digos postales y cambios en distribuci√≥n zonal se realizan al inicio a√±o y para cualquier modificaci√≥n debe remitirse a Beatriz Ruiz / Laura G√≥miz.",documentos:[{texto:"Formulario de Gesti√≥n",url:"SPECIAL_FORM_PREASIGNACIONES"}]},{id:7,tipo:"Gestiones Operativas - Facturaciones - Modificaciones importes - Incidencias Tarifas",destinatario:"Tsr de Soporte",descripcion:"Adelantos de facturaci√≥n (justificado), modificaciones de servicios mal facturados. Modificaciones o incidencias en aplicaci√≥n de tarifas, en desplazamientos, guardias, bonus, desviaciones en tarifas.",documentos:[{texto:"Enviar correo a Soporte",url:"SPECIAL_FORM_TARIFAS"}]},{id:11,tipo:"Gesti√≥n Legal - Contratos - Embargos - Demandas - Accidentes - Incidencias",destinatario:"Tsr de Soporte",descripcion:"En este apartado puedes llevar a cabo gestiones y/o consultas vinculadas a la relaci√≥n del proveedor con Mapfre como: solicitudes de los contratos de colaboraci√≥n en vigor, estado de embargos, comunicaci√≥n o consulta de incidencias graves con asegurados, accidentes, relaciones laborables, etc.",documentos:[{texto:"Enviar correo a Soporte",url:"SPECIAL_FORM_LEGAL"}]},{id:10,tipo:"Gesti√≥n Legal - Documentaci√≥n CAE / PRL (6Conecta)",destinatario:"Tsr de Soporte",descripcion:"Dudas o incidencias en gesti√≥n documental CAE / PRL",documentos:[{texto:"GU√çA 6CONECTA",url:"https://mapfrecorp.sharepoint.com/sites/GO365EECOMPUSGIBEES-AREAPROVEPATRI/Documentos%20compartidos/Documentaci%C3%B3n%20compartida/6Conecta%20(PRL%20Y%20CAE)/GU%C3%8DA%206CONECTA%20PARA%20GESTI%C3%93N%20DOCUMENTACI%C3%93N%20MAPFRE.ppsx"},{texto:"Enviar correo a Soporte",url:"SPECIAL_FORM_DOCUMENTACION"}]},{id:12,tipo:"Imagen Corporativa - Rotulaci√≥n - Ropa de Trabajo - Carn√©s",destinatario:"Tsr de Soporte",descripcion:"Recuerda que las rotulaciones es para veh√≠culos blancos en buen estado, asegurados en Mapfre / Verti. Para la solicitud de carn√©s para empresa indica n√∫mero con nombres de operarios y DNI.",documentos:[{texto:"Formulario Imagen Corporativa",url:"SPECIAL_FORM_IMAGEN"}]},{id:15,tipo:"Incidencias en Aplicaciones del Profesional",destinatario:"Tsr de Soporte",descripcion:"Incidencias en INFOCOL / APPCOL en las que ser√° necesario n¬∫ incidencia SAU y en Appcol env√≠o de logs para su seguimiento",documentos:[{texto:"Enviar correo a Soporte",url:"SPECIAL_FORM_APLICACIONES"}]},{id:16,tipo:"Formaci√≥n de Proveedores",destinatario:"Rafael Rubio",descripcion:"Formaci√≥n de Reciclaje para proveedor, indicando materia o carencia detectada",documentos:[{texto:"Formaci√≥n Profesionales",url:"https://mapfrecorp.sharepoint.com/sites/GO365EECOMPUSGIBEES-AREAPROVEPATRI/Documentos%20compartidos/Documentaci%C3%B3n%20compartida/Formaci%C3%B3n/Formaci%C3%B3n%20Profesionales"},{texto:"Formaci√≥n TSR",url:"https://mapfrecorp.sharepoint.com/sites/GO365EECOMPUSGIBEES-AREAPROVEPATRI/Documentos%20compartidos/Documentaci%C3%B3n%20compartida/Formaci%C3%B3n/Formaci%C3%B3n%20TSR%202025"},{texto:"Enviar correo a Rafael Rubio",url:"SPECIAL_FORM_FORMACION"}]},{id:17,tipo:"Consultas Red Comercial",destinatario:"Tsr de Soporte",descripcion:"Te adjuntamos una plantilla con indicaciones para que la puedas remitir al agente que precise intervenci√≥n de Soporte. Recuerda informarle que por este canal exclusivamente se atienden cuestiones relacionadas con la red de proveedores.",documentos:[{texto:"Plantilla a enviar a agente",url:"SPECIAL_FORM_RED_COMERCIAL"}]},{id:18,tipo:"Incidencias Equipamiento Tecnol√≥gico SAU",destinatario:"SAU",descripcion:"Gu√≠a para restablecer contrase√±a y acceso al SAU para comunicar incidencias en tu puesto de trabajo y dispositivos m√≥viles / PC",documentos:[{texto:"Gu√≠a para restablecer contrase√±a",url:"https://mapfre.tts-cloud.com/publisher/download/document/7p9dl53jo28e0omder4p7hww8/1.29?mimetype=application%2Fpdf&fileextension=pdf&externalwindow=true"},{texto:"Problema en dispositivo y/o m√≥vil",url:"https://smaportal.mapfre.net/sm/ess/smOfferingPage?query=dispositivo%20m%C3%B3vil&entityId=WORK%20ENVIRONMENT_L1%23TELEPHONY_L2%23CONVERGENT%20TELEPHONY%20(ES)_L3%23INCIDENT%20ON%20DEVICE%20AND%2FOR%20MOBILE%20LINE%20(ES)_L4%23PROBLEM%20IN%20DEVICE%20AND%2FOR%20MOBILE%20LINE%20(ES)_L5_SUP&TENANTID=783319272"},{texto:"Problema en ordenador",url:"https://smaportal.mapfre.net/sm/ess/smOfferingPage?entityId=WORK%20ENVIRONMENT_L1%23IT%20EQUIPMENT_L2%23COMPUTER%20(DESKTOP)%20(ES)_L3%23COMPUTER%20(DESKTOP)%20(ES)_L4%23PROBLEM%20IN%20COMPUTER%20(PC,%20LAPTOP,THIN%20CLIENT)%20(ES)_L5_SUP&TENANTID=783319272"},{texto:"Portal SAU",url:"https://smaportal.mapfre.net/sm/ess?TENANTID=783319272"}]}];
let currentView='list',filteredGestiones=[...gestiones];
function renderList(){const e=document.getElementById("listView");e.innerHTML="",filteredGestiones.forEach(t=>{const o=document.createElement("div");o.className="gestion-card",o.onclick=()=>showDetail(t.id),o.innerHTML=`<h3>${t.tipo}</h3><div class="gestion-meta"><span class="badge badge-destinatario">üë§ ${t.destinatario}</span><span class="badge badge-docs">üìÑ ${t.documentos.length} documento${1!==t.documentos.length?"s":""}</span></div><p>${t.descripcion}</p>`,e.appendChild(o)}),document.getElementById("noResults").classList.toggle("hidden",filteredGestiones.length>0)}
function showDetail(e){const t=gestiones.find(t=>t.id===e),o=document.getElementById("detailView");let s=t.documentos.map((e,t)=>{if(e.url==="SPECIAL_FORM_1"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>Selecciona la opci√≥n:</label><select id="tipoSolicitud" onchange="updateSubject()"><option value="">-- Selecciona --</option><option value="Solicitud de Contrato de Alta Reparador">Solicitud de Contrato de Alta Reparador</option><option value="Solicitud Cambio Raz√≥n Social">Solicitud Cambio Raz√≥n Social</option><option value="Baja Total Reparador">Baja Total Reparador</option><option value="Baja voluntaria">Baja voluntaria</option></select></div><button class="doc-button" onclick="enviarFormulario()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_ALTA_BAJA"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>Tipo de gesti√≥n:</label><select id="tipoGestion" onchange="toggleCamposAltaBaja()"><option value="">-- Selecciona opci√≥n --</option><option value="Alta">Alta</option><option value="Baja">Baja</option></select></div><div class="form-group" id="motivoBajaGroup" style="display:none;"><label>Motivo de baja:</label><select id="motivoBaja"><option value="">-- Selecciona Opci√≥n --</option><option value="Motivos Personales">Motivos Personales</option><option value="Vacaciones">Vacaciones</option><option value="Enfermedad / Accidente">Enfermedad / Accidente</option><option value="Saturaci√≥n">Saturaci√≥n</option><option value="Cambio Raz√≥n Social">Cambio Raz√≥n Social</option><option value="Sin Veh√≠culo">Sin Veh√≠culo</option><option value="Fin colaboraci√≥n / Jubilaci√≥n">Fin colaboraci√≥n / Jubilaci√≥n</option><option value="Indicaciones TSR Territorial">Indicaciones TSR Territorial</option></select></div><div class="form-group"><label>N¬∫ Profesional:</label><input type="text" id="numProfesional" placeholder="Ej: 12345"></div><div class="form-group"><label>Fecha inicio:</label><input type="date" id="fechaInicio"></div><div class="form-group" id="fechaFinGroup" style="display:none;"><label>Fecha fin:</label><input type="date" id="fechaFin"></div><div class="form-group" id="sustitutoGroup" style="display:none;"><label>N¬∫ Profesional Sustituto:</label><input type="text" id="sustituto" placeholder="Indica profesional/es sustituto/s"></div><button class="doc-button" onclick="enviarFormularioAltaBaja()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_CAMBIO_GUARDIA"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div id="tablaCambiosGuardia"><table style="width:100%;border-collapse:collapse;margin:15px 0;"><thead><tr><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Profesionales actuales</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Profesionales que van a sustituir al actual</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Zonas de nivel</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Prioridades de guardia en las zonas</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Actividades de guardia</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Fecha desde cuando se solicita el cambio</th><th style="border:1px solid #ccc;padding:8px;background:#f5f5f5;font-size:11px;">Fecha hasta la que se solicita el cambio</th></tr></thead><tbody id="filasTabla"><tr><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XXXXX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XXXXX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="X"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="DD/MM/YY"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="DD/MM/YY"></td></tr></tbody></table></div><button class="doc-button" onclick="agregarFilaGuardia()" style="margin-right:10px;">‚ûï Agregar fila</button><button class="doc-button" onclick="enviarFormularioCambioGuardia()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_PREASIGNACIONES"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>Tipo de gesti√≥n (puedes seleccionar varias):</label><select id="tipoGestionPreasig" multiple style="height:auto;padding:8px;"><option value="Gesti√≥n en zonas / actividades">Gesti√≥n en zonas / actividades</option><option value="Preasignaciones a Profesional">Preasignaciones a Profesional</option><option value="L√≠mites">L√≠mites</option><option value="Otros">Otros</option></select><small style="color:#666;display:block;margin-top:5px;">Mant√©n Ctrl (o Cmd en Mac) para seleccionar m√∫ltiples opciones</small></div><div class="form-group"><label>Describe la gesti√≥n con zonas, profesiones, actividades y/o marcas:</label><textarea id="descripcionGestion" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ los detalles de la gesti√≥n..."></textarea></div><div class="form-group"><label>Fecha a implantar:</label><input type="date" id="fechaImplantar"></div><button class="doc-button" onclick="enviarFormularioPreasignaciones()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_VACACIONES"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional:</label><input type="text" id="numProfVacaciones" placeholder="Ej: 12345"></div><div class="form-group"><label>Fecha inicio:</label><input type="date" id="fechaInicioVacaciones"></div><div class="form-group"><label>Fecha fin:</label><input type="date" id="fechaFinVacaciones"></div><div class="form-group"><label>N¬∫ Profesional Sustituto:</label><input type="text" id="sustitutoVacaciones" placeholder="Indica profesional/es sustituto/s"></div><div class="form-group"><label>Zonas:</label><input type="text" id="zonasVacaciones" placeholder="Ej: Zona 1, Zona 2"></div><div class="form-group"><label>Otra informaci√≥n relevante:</label><textarea id="infoRelevante" rows="3" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Informaci√≥n adicional..."></textarea></div><button class="doc-button" onclick="enviarFormularioVacaciones()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_TARIFAS"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>Tipo de gesti√≥n (puedes seleccionar varias):</label><select id="tipoGestionTarifas" multiple style="height:auto;padding:8px;"><option value="Adelanto facturaci√≥n">Adelanto facturaci√≥n</option><option value="Modificaci√≥n importes">Modificaci√≥n importes</option><option value="Incidencias en c√≥digos de tarifa, desplazamientos, guardias, bonus">Incidencias en c√≥digos de tarifa, desplazamientos, guardias, bonus</option><option value="Desviaciones tarifa">Desviaciones tarifa</option><option value="Otros">Otros</option></select><small style="color:#666;display:block;margin-top:5px;">Mant√©n Ctrl (o Cmd en Mac) para seleccionar m√∫ltiples opciones</small></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;"><div class="form-group"><label>N¬∫ Profesional/es:</label><input type="text" id="numProfTarifas" placeholder="Ej: 12345, 67890"></div><div class="form-group"><label>Zona:</label><input type="text" id="zonaTarifas" placeholder="Ej: Zona 1"></div></div><div class="form-group"><label>Informaci√≥n relevante:</label><textarea id="infoTarifas" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ la informaci√≥n relevante..."></textarea></div><button class="doc-button" onclick="enviarFormularioTarifas()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_MODIFICACIONES"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional:</label><input type="text" id="numProfModif" placeholder="Ej: 12345"></div><div class="form-group"><label>Tipo de modificaci√≥n (puedes seleccionar varias):</label><select id="tipoModificacion" multiple style="height:auto;padding:8px;"><option value="Personas / Direcci√≥n contacto">Personas / Direcci√≥n contacto</option><option value="Tel√©fonos">Tel√©fonos</option><option value="Email">Email</option><option value="Cuenta Bancaria (imprescindible certificado titularidad)">Cuenta Bancaria (imprescindible certificado titularidad)</option></select><small style="color:#666;display:block;margin-top:5px;">Mant√©n Ctrl (o Cmd en Mac) para seleccionar m√∫ltiples opciones</small></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;"><div class="form-group"><label>Si los cambios son temporales - Fecha desde:</label><input type="date" id="fechaDesdeModif"></div><div class="form-group"><label>Fecha hasta:</label><input type="date" id="fechaHastaModif"></div></div><div class="form-group"><label>Nuevos Datos:</label><textarea id="nuevosDatos" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ los nuevos datos..."></textarea></div><button class="doc-button" onclick="enviarFormularioModificaciones()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_IMAGEN"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional:</label><input type="text" id="numProfImagen" placeholder="Ej: 12345"></div><div class="form-group"><label>Selecciona el tipo de gesti√≥n:</label><select id="tipoImagen" onchange="toggleOpcionesImagen()"><option value="">-- Selecciona opci√≥n --</option><option value="Rotulaci√≥n">Rotulaci√≥n</option><option value="Ropa de Trabajo">Ropa de Trabajo</option><option value="Carn√©s">Carn√©s</option></select></div><div id="opcionesRotulacion" style="display:none;"><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">1</div><span class="doc-text">Plantilla Solicitud rotulaci√≥n</span><a href="https://mapfrecorp.sharepoint.com/:x:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Rotulaci%C3%B3n%20vMAR25.xlsm?d=w846c3835904a4cff9683229f78a8560c&csf=1&web=1&e=KeNULL" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">2</div><span class="doc-text">Contacto Talleres Rotulaci√≥n</span><a href="https://mapfrecorp.sharepoint.com/:x:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Contacto%20y%20Direcciones%20de%20Talleres%20para%20Rotulaci%C3%B3n%20Furgonetas.xls?d=w5028c5d8d0a74609bc788c52b14de60e&csf=1&web=1&e=l0apoG" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="form-group"><label>Matr√≠cula/s:</label><input type="text" id="matriculas" placeholder="Ej: 1234ABC, 5678DEF"></div></div><div id="opcionesRopa" style="display:none;"><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">1</div><span class="doc-text">Programa de Fidelizaci√≥n y Calidad</span><a href="https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Operativas/Programa%20Fidelizaci%C3%B3n%20y%20Calidad.docx?d=w47b7e9cfd5ab4a06adf65a18a75f0516&csf=1&web=1&e=1b5hq1" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">2</div><span class="doc-text">Manual programa de fidelizaci√≥n</span><a href="https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Operativas/Manual%20aplicaci%C3%B3n%20programa%20de%20fidelizaci%C3%B3n.docx?d=w14591a8949404589b4a21180fa5a7a76&csf=1&web=1&e=usEqkQ" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">3</div><span class="doc-text">Cat√°logo de prendas</span><a href="https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Plantillas/Cat%C3%A1logo%20de%20prendas%20Proveedores%20Patrimoniales.docx?d=w45532dfcbf674508811c44fca277e642&csf=1&web=1&e=zduT21" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="doc-item" style="margin:10px 0;"><div class="doc-content"><div class="doc-number">4</div><span class="doc-text">C√≥mo realizar tu compra</span><a href="https://mapfrecorp.sharepoint.com/:w:/r/sites/GO365SPOEECOMPUSGIBEES-PROVSERV/Proveedores%20Patrimoniales/Reparadores/Operativas/Ropa%20de%20trabajo.%20C%C3%B3mo%20realizar%20tu%20compra.docx?d=w10f43b3aebd144488c57587539946a02&csf=1&web=1&e=vRoifl" target="_blank" class="doc-button">üìÑ Abrir</a></div></div><div class="form-group"><label>Describe la consulta:</label><textarea id="consultaRopa" rows="4" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe tu consulta..."></textarea></div></div><div id="opcionesCarnes" style="display:none;"><div class="form-group"><label>Para empresas detalla la cantidad, nombre y DNI de los t√©cnicos:</label><textarea id="detallesCarnes" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Cantidad, nombres y DNI..."></textarea></div></div><button class="doc-button" onclick="enviarFormularioImagen()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_DOCUMENTACION"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional / NIF (si procede):</label><input type="text" id="numProfDoc" placeholder="Ej: 12345 o NIF"></div><div class="form-group"><label>Tipo de consulta:</label><select id="tipoConsultaDoc"><option value="">-- Selecciona opci√≥n --</option><option value="Problema de acceso">Problema de acceso</option><option value="Enviar gu√≠a / video">Enviar gu√≠a / video</option><option value="Duda uso">Duda uso</option><option value="Validaci√≥n / rechazo documentaci√≥n">Validaci√≥n / rechazo documentaci√≥n</option><option value="Otras consultas">Otras consultas</option></select></div><div class="form-group"><label>Detalla consulta / incidencia:</label><textarea id="detalleDoc" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ la consulta o incidencia..."></textarea></div><button class="doc-button" onclick="enviarFormularioDocumentacion()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_LEGAL"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>Describe solicitud o incidencia aportando cuantos datos sean necesarios para la gesti√≥n:</label><textarea id="detalleLegal" rows="8" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ la solicitud o incidencia con todos los detalles necesarios..."></textarea></div><button class="doc-button" onclick="enviarFormularioLegal()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_APLICACIONES"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional (si aplica):</label><input type="text" id="numProfApp" placeholder="Ej: 12345"></div><div class="form-group"><label>Descripci√≥n incidencia:</label><textarea id="descripcionApp" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ la incidencia..."></textarea></div><button class="doc-button" onclick="enviarFormularioAplicaciones()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_FORMACION"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div class="form-group"><label>N¬∫ Profesional/es:</label><input type="text" id="numProfForm" placeholder="Ej: 12345, 67890"></div><div class="form-group"><label>Describe necesidades, disponibilidad y cuantos detalles sean de inter√©s:</label><textarea id="detallesForm" rows="6" style="width:100%;padding:8px;border:2px solid #e0e0e0;border-radius:5px;font-size:14px;font-family:inherit;" placeholder="Describe aqu√≠ las necesidades y detalles..."></textarea></div><button class="doc-button" onclick="enviarFormularioFormacion()">‚úâÔ∏è Enviar correo</button></div></div></div>`;}if(e.url==="SPECIAL_FORM_RED_COMERCIAL"){return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><div style="flex:1;"><div style="background:#fff3cd;border:2px solid #ffc107;border-radius:8px;padding:15px;margin-bottom:15px;"><h4 style="color:#856404;margin-bottom:10px;">‚ÑπÔ∏è INFORMACI√ìN RELEVANTE:</h4><p style="color:#856404;margin:5px 0;font-size:13px;">Este canal es exclusivo para consultas o incidencias que relacionadas con la intervenci√≥n de proveedores patrimoniales.</p><p style="color:#856404;margin:5px 0;font-size:13px;">Evita duplicar gestiones. No env√≠es correos si recientemente has reclamado a trav√©s de GESCOM.</p><p style="color:#856404;margin:5px 0;font-size:13px;">En correos a Soporte no incluyas a otros destinatarios en el PARA.</p><p style="color:#856404;margin:5px 0;font-size:13px;">No incluyas a Soporte en CC</p><p style="color:#856404;margin:5px 0;font-size:13px;">No env√≠es correos a Soporte correos meramente informativos o incluyas en hilos de correos gestionados por otros.</p><p style="color:#856404;margin:5px 0;font-size:13px;font-weight:bold;">Mant√©n en el asunto autom√°tico del correo "RED COMERCIAL - N√∫mero de expediente</p></div><button class="doc-button" onclick="enviarFormularioRedComercial()">‚úâÔ∏è Abrir correo</button></div></div></div>`;}if(e.url){let o=e.texto;if(e.url.startsWith("mailto:"))return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><span class="doc-text">${o}</span><a href="${e.url}" class="doc-button">‚úâÔ∏è Abrir correo</a></div></div>`;if(e.texto.includes(".doc")||e.texto.includes(".xls")||e.texto.includes(".msg")){const t=e.texto.split("/");o=t[t.length-1].split("?")[0]}return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><span class="doc-text">${o}</span><a href="${e.url}" target="_blank" class="doc-button">üìÑ Abrir</a></div></div>`}return`<div class="doc-item"><div class="doc-content"><div class="doc-number">${t+1}</div><span class="doc-text">${e.texto}</span></div></div>`}).join("");o.innerHTML=`<button class="back-button" onclick="showList()">‚Üê Volver al √≠ndice</button><div class="detail-header"><h2>${t.tipo}</h2><div class="gestion-meta" style="margin-bottom: 15px;"><span class="badge badge-destinatario">üë§ ${t.destinatario}</span></div><p>${t.descripcion}</p></div><div class="docs-section"><h3>üìÑ Documentaci√≥n Asociada</h3>${s}</div>`,document.getElementById("listView").classList.add("hidden"),document.getElementById("detailView").classList.remove("hidden"),document.getElementById("noResults").classList.add("hidden"),currentView="detail"}
function enviarFormulario(){const sel=document.getElementById("tipoSolicitud");if(!sel||sel.value===""){alert("Por favor, selecciona una opci√≥n antes de enviar el correo.");return}const subject=encodeURIComponent(sel.value);const bodyText="Buenos d√≠as,\n\n"+sel.value+"\n\nRecuerda que debes de adjuntar plantilla correspondiente a la petici√≥n. Para ceses actividad no olvides revisar cuadrante anual de guardias, preasignaciones a eliminar, servicios pendientes y facturaci√≥n (deudas).\n\n\n\nUn saludo";const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function formatearFecha(fechaISO){if(!fechaISO)return "";const[year,month,day]=fechaISO.split("-");const yearShort=year.substring(2);return `${day}/${month}/${yearShort}`}
function toggleCamposAltaBaja(){const tipoGestion=document.getElementById("tipoGestion");const motivoBajaGroup=document.getElementById("motivoBajaGroup");const fechaFinGroup=document.getElementById("fechaFinGroup");const sustitutoGroup=document.getElementById("sustitutoGroup");if(tipoGestion&&motivoBajaGroup&&fechaFinGroup&&sustitutoGroup){if(tipoGestion.value==="Baja"){motivoBajaGroup.style.display="block";fechaFinGroup.style.display="block";sustitutoGroup.style.display="block"}else if(tipoGestion.value==="Alta"){motivoBajaGroup.style.display="none";fechaFinGroup.style.display="none";sustitutoGroup.style.display="none"}else{motivoBajaGroup.style.display="none";fechaFinGroup.style.display="none";sustitutoGroup.style.display="none"}}}
function enviarFormularioAltaBaja(){const tipoGestion=document.getElementById("tipoGestion")?.value;const motivoBaja=document.getElementById("motivoBaja")?.value;const numProfesional=document.getElementById("numProfesional")?.value;const fechaInicio=document.getElementById("fechaInicio")?.value;const fechaFin=document.getElementById("fechaFin")?.value;const sustituto=document.getElementById("sustituto")?.value;if(!tipoGestion){alert("Por favor, selecciona el tipo de gesti√≥n (Alta o Baja).");return}if(!numProfesional||!numProfesional.trim()){alert("Por favor, completa el campo N¬∫ Profesional.");return}if(!fechaInicio){alert("Por favor, completa el campo Fecha inicio.");return}if(tipoGestion==="Baja"){if(!motivoBaja){alert("Por favor, selecciona el motivo de baja.");return}if(!fechaFin){alert("Por favor, completa el campo Fecha fin.");return}if(!sustituto||!sustituto.trim()){alert("Por favor, completa el campo N¬∫ Profesional Sustituto.");return}}const motivoFinal=tipoGestion==="Baja"?motivoBaja:"Alta";const fechaInicioFormateada=formatearFecha(fechaInicio);const fechaFinFormateada=fechaFin?formatearFecha(fechaFin):"N/A";const subjectText=`${tipoGestion} - ${fechaInicioFormateada} - N¬∫ ${numProfesional}`;const subject=encodeURIComponent(subjectText);let bodyText=`Buenos d√≠as,\n\nRecuerda que los d√≠as de alta y baja han de ser laborables. Revisa los cuadrantes de guardia y planifica si no hay fecha prevista de incorporaci√≥n. Informa al profesional que causa baja que actualice sus servicios pendientes e indica si hay que hacer gestiones para reasignarlos. Informa a los sustitutos.\n\nNo Profesional: ${numProfesional}\nFecha inicio: ${fechaInicioFormateada}\n`;if(tipoGestion==="Baja"){bodyText+=`Fecha fin: ${fechaFinFormateada}\nMotivo: ${motivoFinal}\nN¬∫ Profesional Sustituto: ${sustituto}\n`}bodyText+=`\nInforma aqu√≠ de otros datos de inter√©s como los motivos por los que le inhabilitas, gestiones a realizar en actividades, zonas, guardias...\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function agregarFilaGuardia(){const tbody=document.getElementById("filasTabla");const nuevaFila=document.createElement("tr");nuevaFila.innerHTML=`<td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XXXXX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XXXXX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="X"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="XX"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="DD/MM/YY"></td><td style="border:1px solid #ccc;padding:5px;"><input type="text" style="width:100%;border:none;padding:4px;" placeholder="DD/MM/YY"></td>`;tbody.appendChild(nuevaFila)}
function enviarFormularioCambioGuardia(){const filas=document.getElementById("filasTabla").getElementsByTagName("tr");if(filas.length===0){alert("Por favor, completa al menos una fila de la tabla.");return}const primeraFila=filas[0].getElementsByTagName("input");const fechaDesde=primeraFila[5].value||"";const actividad=primeraFila[4].value||"";let tablaTexto="Profesionales actuales | Profesionales que van a sustituir al actual | Zonas de nivel | Prioridades de guardia en las zonas | Actividades de guardia | Fecha desde cuando se solicita el cambio | Fecha hasta la que se solicita el cambio\n";for(let i=0;i<filas.length;i++){const inputs=filas[i].getElementsByTagName("input");const fila=[];for(let j=0;j<inputs.length;j++){fila.push(inputs[j].value||inputs[j].placeholder)}tablaTexto+=fila.join(" | ")+"\n"}const subjectText=`CAMBIO DE GUARDIA - ${fechaDesde} / ${actividad}`;const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\nPor favor, ruego realic√©is el siguiente cambio de guardia:\n\n${tablaTexto}\n* Se deber√° rellenar una fila por cada cambio solicitado.\n* Si el profesional sustituto realiza la guardia de varias actividades, hay que indicar todas las afectadas.\n* Si el profesional sustituto realiza la guardia de varias zonas, hay que indicar todas las afectadas.\n* Si el profesional a sustituir realiza la guardia de varias prioridades, hay que indicar todas las afectadas.\n* Preferiblemente el profesional sustituto deber√° asumir la guardia de la semana completa. Solo se realizar√°n cambios parciales en casos excepcionales.\n* Si se solicita un cambio de guardia que implique varias zonas, el profesional sustituto tiene que asumir las mismas zonas que el profesional saliente.\n* Toda aquella solicitud que no se reciba correctamente, no ser√° gestionada y ser√° devuelta con copia al JSR o Coordinador de Soporte, seg√∫n corresponda, solicitando el env√≠o de la plantilla o la informaci√≥n que falte\n* Siempre que se d√© baja TOTAL o TEMPORAL a un profesional, se deber√° revisar si dicho profesional pudiese estar de guardia durante todo el periodo que afecte para gestionar su sustituci√≥n.\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioPreasignaciones(){const selectElement=document.getElementById("tipoGestionPreasig");const selectedOptions=Array.from(selectElement.selectedOptions).map(opt=>opt.value).filter(val=>val!=="");const descripcion=document.getElementById("descripcionGestion")?.value;const fechaImplantar=document.getElementById("fechaImplantar")?.value;if(selectedOptions.length===0){alert("Por favor, selecciona al menos un tipo de gesti√≥n.");return}if(!descripcion||descripcion.trim()===""){alert("Por favor, describe la gesti√≥n.");return}const tipoGestion=selectedOptions.join(" / ");const fechaFormateada=fechaImplantar?formatearFecha(fechaImplantar):"Sin fecha especificada";const subjectText=`${tipoGestion} - ${fechaFormateada}`;const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\n\nRecuerda revisar datos de profesionales, zonas, c√≥digos postales, actividades a poner/quitar y si est√°n sujetas a periodos vacacionales, marcas y cuantos datos sean necesarios para llevar a cabo la gesti√≥n.\n\n${descripcion}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioVacaciones(){const numProf=document.getElementById("numProfVacaciones")?.value;const fechaInicio=document.getElementById("fechaInicioVacaciones")?.value;const fechaFin=document.getElementById("fechaFinVacaciones")?.value;const sustituto=document.getElementById("sustitutoVacaciones")?.value;const zonas=document.getElementById("zonasVacaciones")?.value;const infoRelevante=document.getElementById("infoRelevante")?.value;if(!numProf||!numProf.trim()){alert("Por favor, completa el campo N¬∫ Profesional.");return}if(!fechaInicio){alert("Por favor, completa el campo Fecha inicio.");return}if(!fechaFin){alert("Por favor, completa el campo Fecha fin.");return}if(!sustituto||!sustituto.trim()){alert("Por favor, completa el campo N¬∫ Profesional Sustituto.");return}if(!zonas||!zonas.trim()){alert("Por favor, completa el campo Zonas.");return}if(!infoRelevante||!infoRelevante.trim()){alert("Por favor, completa el campo Otra informaci√≥n relevante.");return}const fechaInicioFormateada=formatearFecha(fechaInicio);const fechaFinFormateada=formatearFecha(fechaFin);const subjectText=`CESE TEMPORAL ACTIVIDAD - ${numProf} - ${fechaInicioFormateada}`;const subject=encodeURIComponent(subjectText);const bodyText=`‚ö†Ô∏èPresta atenci√≥n en las comunicaciones con Proveedores ‚Äì Laboralidad. Peticiones fuera de las vacaciones estivales planificadas.\n\nRecuerda al profesional que debe actualizar el estado de sus servicios e informar a los asegurados. Informa a todos los profesionales sustitutos.\n\nBuenos d√≠as,\n\nN¬∫ Profesional: ${numProf}\nFecha inicio: ${fechaInicioFormateada}\nFecha fin: ${fechaFinFormateada}\nN¬∫ Profesional Sustituto: ${sustituto}\nZonas: ${zonas}\nOtra informaci√≥n relevante: ${infoRelevante}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioTarifas(){const selectElement=document.getElementById("tipoGestionTarifas");const selectedOptions=Array.from(selectElement.selectedOptions).map(opt=>opt.value).filter(val=>val!=="");const numProf=document.getElementById("numProfTarifas")?.value;const zona=document.getElementById("zonaTarifas")?.value;const info=document.getElementById("infoTarifas")?.value;if(selectedOptions.length===0){alert("Por favor, selecciona al menos un tipo de gesti√≥n.");return}if(!numProf||!numProf.trim()){alert("Por favor, completa el campo N¬∫ Profesional/es.");return}if(!zona||!zona.trim()){alert("Por favor, completa el campo Zona.");return}if(!info||!info.trim()){alert("Por favor, completa el campo Informaci√≥n relevante.");return}const tipoGestion=selectedOptions.join(" / ");const subjectText=`${tipoGestion} - ${numProf}`;const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\n\nSi la gesti√≥n implica a varios profesionales / expedientes adjunta datos en un archivo excel.\n\nN¬∫ Profesional/es: ${numProf}\nZona: ${zona}\n\n${info}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioModificaciones(){const numProf=document.getElementById("numProfModif")?.value;const selectElement=document.getElementById("tipoModificacion");const selectedOptions=Array.from(selectElement.selectedOptions).map(opt=>opt.value).filter(val=>val!=="");const fechaDesde=document.getElementById("fechaDesdeModif")?.value;const fechaHasta=document.getElementById("fechaHastaModif")?.value;const nuevosDatos=document.getElementById("nuevosDatos")?.value;if(!numProf||!numProf.trim()){alert("Por favor, completa el campo N¬∫ Profesional.");return}if(selectedOptions.length===0){alert("Por favor, selecciona al menos un tipo de modificaci√≥n.");return}if(!nuevosDatos||!nuevosDatos.trim()){alert("Por favor, completa el campo Nuevos Datos.");return}const tipoModif=selectedOptions.join(" / ");const subjectText=`${numProf} - ${tipoModif}`;const subject=encodeURIComponent(subjectText);let bodyText=`Buenos d√≠as,\n\nRecuerda que para cambios de cuenta corriente es imprescindible que adjuntes certificado de titularidad.\n\nN¬∫ Profesional: ${numProf}\nTipo de modificaci√≥n: ${tipoModif}\n`;if(fechaDesde||fechaHasta){const fechaDesdeFormat=fechaDesde?formatearFecha(fechaDesde):"";const fechaHastaFormat=fechaHasta?formatearFecha(fechaHasta):"";bodyText+=`Cambios temporales:\nFecha desde: ${fechaDesdeFormat}\nFecha hasta: ${fechaHastaFormat}\n`}bodyText+=`\nNuevos Datos:\n${nuevosDatos}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function toggleOpcionesImagen(){const tipoImagen=document.getElementById("tipoImagen")?.value;const opcionesRotulacion=document.getElementById("opcionesRotulacion");const opcionesRopa=document.getElementById("opcionesRopa");const opcionesCarnes=document.getElementById("opcionesCarnes");if(opcionesRotulacion)opcionesRotulacion.style.display="none";if(opcionesRopa)opcionesRopa.style.display="none";if(opcionesCarnes)opcionesCarnes.style.display="none";if(tipoImagen==="Rotulaci√≥n"&&opcionesRotulacion){opcionesRotulacion.style.display="block"}else if(tipoImagen==="Ropa de Trabajo"&&opcionesRopa){opcionesRopa.style.display="block"}else if(tipoImagen==="Carn√©s"&&opcionesCarnes){opcionesCarnes.style.display="block"}}
function enviarFormularioImagen(){const numProf=document.getElementById("numProfImagen")?.value;const tipoImagen=document.getElementById("tipoImagen")?.value;if(!numProf||!numProf.trim()){alert("Por favor, completa el campo N¬∫ Profesional.");return}if(!tipoImagen){alert("Por favor, selecciona el tipo de gesti√≥n.");return}let subjectText="";let bodyText="";if(tipoImagen==="Rotulaci√≥n"){const matriculas=document.getElementById("matriculas")?.value;if(!matriculas||!matriculas.trim()){alert("Por favor, completa el campo Matr√≠cula/s.");return}subjectText=`Rotulaci√≥n - ${numProf}`;bodyText=`IMPORTANTE: Adjunta Plantilla Solicitud Rotulaci√≥n\n\nBuenos d√≠as,\n\nN¬∫ Profesional: ${numProf}\nMatr√≠cula/s: ${matriculas}\n\nUn saludo`}else if(tipoImagen==="Ropa de Trabajo"){const consulta=document.getElementById("consultaRopa")?.value;if(!consulta||!consulta.trim()){alert("Por favor, describe la consulta.");return}subjectText=`Ropa de Trabajo - ${numProf}`;bodyText=`Buenos d√≠as,\n\nN¬∫ Profesional: ${numProf}\n\nConsulta:\n${consulta}\n\nUn saludo`}else if(tipoImagen==="Carn√©s"){const detalles=document.getElementById("detallesCarnes")?.value;if(!detalles||!detalles.trim()){alert("Por favor, completa los detalles de los carn√©s.");return}subjectText=`Carn√©s - ${numProf}`;bodyText=`Buenos d√≠as,\n\nN¬∫ Profesional: ${numProf}\n\n${detalles}\n\nUn saludo`}const subject=encodeURIComponent(subjectText);const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioDocumentacion(){const numProf=document.getElementById("numProfDoc")?.value||"";const tipoConsulta=document.getElementById("tipoConsultaDoc")?.value;const detalle=document.getElementById("detalleDoc")?.value;if(!tipoConsulta){alert("Por favor, selecciona el tipo de consulta.");return}if(!detalle||!detalle.trim()){alert("Por favor, completa el campo Detalla consulta / incidencia.");return}const subjectText=numProf.trim()?`${tipoConsulta} - ${numProf}`:tipoConsulta;const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\n\n${numProf.trim()?`N¬∫ Profesional: ${numProf}\n\n`:""}${detalle}\n\nENLACE A VIDEO https://youtu.be/D3wi7M0QjGE\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioLegal(){const detalle=document.getElementById("detalleLegal")?.value;if(!detalle||!detalle.trim()){alert("Por favor, completa la descripci√≥n de la solicitud o incidencia.");return}const subject=encodeURIComponent("CONSULTA LEGAL");const bodyText=`Buenos d√≠as,\n\n${detalle}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioAplicaciones(){const numProf=document.getElementById("numProfApp")?.value||"";const descripcion=document.getElementById("descripcionApp")?.value;if(!descripcion||!descripcion.trim()){alert("Por favor, completa el campo Descripci√≥n incidencia.");return}const subjectText=numProf.trim()?`Incidencia Aplicaciones - ${numProf}`:"Incidencia Aplicaciones";const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\n\n${numProf.trim()?`N¬∫ Profesional: ${numProf}\n\n`:""}${descripcion}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:tsrdesoporte@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioFormacion(){const numProf=document.getElementById("numProfForm")?.value;const detalles=document.getElementById("detallesForm")?.value;if(!numProf||!numProf.trim()){alert("Por favor, completa el campo N¬∫ Profesional/es.");return}if(!detalles||!detalles.trim()){alert("Por favor, completa la descripci√≥n de necesidades y detalles.");return}const subjectText=`FORMACI√ìN RECICLAJE - ${numProf}`;const subject=encodeURIComponent(subjectText);const bodyText=`Buenos d√≠as,\n\nN¬∫ Profesional/es: ${numProf}\n\n${detalles}\n\nUn saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:rrubio@mapfre.com?subject=${subject}&body=${body}`}
function enviarFormularioRedComercial(){const subjectText="RED COMERCIAL";const subject=encodeURIComponent(subjectText);const bodyText=`INFORMACI√ìN RELEVANTE:

Este canal es exclusivo para consultas o incidencias que relacionadas con la intervenci√≥n de proveedores patrimoniales.

Evita duplicar gestiones. No env√≠es correos si recientemente has reclamado a trav√©s de GESCOM.

En correos a Soporte no incluyas a otros destinatarios en el PARA.

No incluyas a Soporte en CC

No env√≠es correos a Soporte correos meramente informativos o incluyas en hilos de correos gestionados por otros.

Mant√©n en el asunto autom√°tico del correo "RED COMERCIAL - N√∫mero de expediente

---

Estimado equipo Soporte:

Expediente/s N¬∫:

Descripci√≥n de consulta / incidencia:


Un saludo`;const body=encodeURIComponent(bodyText);window.location.href=`mailto:?subject=${subject}&body=${body}`}
function establecerFechasMinimas(){const hoy=new Date().toISOString().split('T')[0];const fechaInputs=document.querySelectorAll('input[type="date"]');fechaInputs.forEach(input=>{input.setAttribute('min',hoy)})}
function showList(){document.getElementById("listView").classList.remove("hidden"),document.getElementById("detailView").classList.add("hidden"),currentView="list",renderList()}
document.getElementById("searchInput").addEventListener("input",e=>{const t=e.target.value.toLowerCase();filteredGestiones=gestiones.filter(e=>e.tipo.toLowerCase().includes(t)||e.destinatario.toLowerCase().includes(t)||e.descripcion.toLowerCase().includes(t)),"list"===currentView&&renderList()}),renderList();
const observer=new MutationObserver(establecerFechasMinimas);observer.observe(document.body,{childList:true,subtree:true});establecerFechasMinimas();
    </script>

    <!-- Service Worker para PWA -->
    <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('Service Worker registrado'))
                .catch(err => console.log('Error en Service Worker:', err));
        });
    }
    </script>

</body>
</html>
